{"version":3,"sources":["../../src/lib/download-wasm-swc.ts"],"names":["downloadWasmSwc","Log","MAX_VERSIONS_TO_CACHE","version","wasmDirectory","variant","pkgName","tarFileName","substring","outputDirectory","path","join","fileExists","cacheDirectory","result","envDefined","process","env","systemCacheDirectory","platform","XDG_CACHE_HOME","os","homedir","LOCALAPPDATA","dir","tmpdir","console","error","Error","exit","isAbsolute","resolve","cwd","fs","promises","mkdir","recursive","extractFromTar","tar","x","file","strip","info","tempFile","Date","now","registry","getRegistry","fetch","then","res","ok","status","cacheWriteStream","createWriteStream","Promise","reject","body","pipe","on","err","finally","close","rename","cacheFiles","readdir","length","sort","a","b","localeCompare","i","unlink","catch"],"mappings":"AAAA;;;;QAWsBA,eAAe,GAAfA,eAAe;AAXtB,IAAA,GAAI,kCAAJ,IAAI,EAAA;AACJ,IAAA,GAAI,kCAAJ,IAAI,EAAA;AACF,IAAA,KAAM,kCAAN,MAAM,EAAA;AACXC,IAAAA,GAAG,mCAAM,qBAAqB,EAA3B;AACC,IAAA,IAAwB,kCAAxB,wBAAwB,EAAA;AACtB,IAAA,UAA+B,kCAA/B,+BAA+B,EAAA;AACtB,IAAA,WAAe,WAAf,eAAe,CAAA;AACd,IAAA,YAAwB,WAAxB,wBAAwB,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEpD,MAAMC,qBAAqB,GAAG,CAAC;AAExB,eAAeF,eAAe,CACnCG,OAAe,EACfC,aAAqB,EACrBC,OAAyB,GAAG,QAAQ,EACpC;IACA,MAAMC,OAAO,GAAG,CAAC,eAAe,EAAED,OAAO,CAAC,CAAC;IAC3C,MAAME,WAAW,GAAG,CAAC,EAAED,OAAO,CAACE,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,EAAEL,OAAO,CAAC,IAAI,CAAC;IAC5D,MAAMM,eAAe,GAAGC,KAAI,QAAA,CAACC,IAAI,CAACP,aAAa,EAAEE,OAAO,CAAC;IAEzD,IAAI,MAAMM,CAAAA,GAAAA,WAAU,AAAiB,CAAA,WAAjB,CAACH,eAAe,CAAC,EAAE;QACrC,mDAAmD;QACnD,0CAA0C;QAC1C,OAAM;KACP;IAED,2EAA2E;IAC3E,4IAA4I;IAC5I,MAAMI,cAAc,GAAG,MAAM,CAAC,UAAY;QACxC,IAAIC,MAAM;QACV,MAAMC,UAAU,GAAGC,OAAO,CAACC,GAAG,CAAC,eAAe,CAAC;QAE/C,IAAIF,UAAU,EAAE;YACdD,MAAM,GAAGC,UAAU;SACpB,MAAM;YACL,IAAIG,oBAAoB;YACxB,IAAIF,OAAO,CAACG,QAAQ,KAAK,OAAO,EAAE;gBAChCD,oBAAoB,GAClBF,OAAO,CAACC,GAAG,CAACG,cAAc,IAAIV,KAAI,QAAA,CAACC,IAAI,CAACU,GAAE,QAAA,CAACC,OAAO,EAAE,EAAE,QAAQ,CAAC;aAClE,MAAM,IAAIN,OAAO,CAACG,QAAQ,KAAK,QAAQ,EAAE;gBACxCD,oBAAoB,GAAGR,KAAI,QAAA,CAACC,IAAI,CAACU,GAAE,QAAA,CAACC,OAAO,EAAE,EAAE,SAAS,EAAE,QAAQ,CAAC;aACpE,MAAM,IAAIN,OAAO,CAACG,QAAQ,KAAK,OAAO,EAAE;gBACvCD,oBAAoB,GAClBF,OAAO,CAACC,GAAG,CAACM,YAAY,IACxBb,KAAI,QAAA,CAACC,IAAI,CAACU,GAAE,QAAA,CAACC,OAAO,EAAE,EAAE,SAAS,EAAE,OAAO,CAAC;aAC9C,MAAM;gBACL,+DAA+D;gBAC/D,IAAI,CAACJ,oBAAoB,EAAE;oBACzB,KAAK,MAAMM,GAAG,IAAI;wBAChBd,KAAI,QAAA,CAACC,IAAI,CAACU,GAAE,QAAA,CAACC,OAAO,EAAE,EAAE,QAAQ,CAAC;wBACjCZ,KAAI,QAAA,CAACC,IAAI,CAACU,GAAE,QAAA,CAACI,MAAM,EAAE,CAAC;qBACvB,CAAE;wBACD,IAAI,MAAMb,CAAAA,GAAAA,WAAU,AAAK,CAAA,WAAL,CAACY,GAAG,CAAC,EAAE;4BACzBN,oBAAoB,GAAGM,GAAG;4BAC1B,MAAK;yBACN;qBACF;iBACF;gBAED,IAAI,CAACN,oBAAoB,EAAE;oBACzBQ,OAAO,CAACC,KAAK,CAAC,IAAIC,KAAK,CAAC,wBAAwB,GAAGZ,OAAO,CAACG,QAAQ,CAAC,CAAC;oBACrEH,OAAO,CAACa,IAAI,CAAC,CAAC,CAAC;iBAChB;aACF;YACDf,MAAM,GAAGJ,KAAI,QAAA,CAACC,IAAI,CAACO,oBAAoB,EAAE,UAAU,CAAC;SACrD;QAED,IAAI,CAACR,KAAI,QAAA,CAACoB,UAAU,CAAChB,MAAM,CAAC,EAAE;YAC5B,mDAAmD;YACnD,uCAAuC;YACvC,6EAA6E;YAC7E,yEAAyE;YACzE,gDAAgD;YAChDA,MAAM,GAAGJ,KAAI,QAAA,CAACqB,OAAO,CAACf,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC,IAAID,OAAO,CAACgB,GAAG,EAAE,EAAElB,MAAM,CAAC;SACxE;QACD,OAAOA,MAAM,CAAA;KACd,CAAC,EAAE;IAEJ,MAAMmB,GAAE,QAAA,CAACC,QAAQ,CAACC,KAAK,CAAC1B,eAAe,EAAE;QAAE2B,SAAS,EAAE,IAAI;KAAE,CAAC;IAE7D,MAAMC,cAAc,GAAG,UAAY;QACjC,MAAMC,IAAG,QAAA,CAACC,CAAC,CAAC;YACVC,IAAI,EAAE9B,KAAI,QAAA,CAACC,IAAI,CAACE,cAAc,EAAEN,WAAW,CAAC;YAC5CyB,GAAG,EAAEvB,eAAe;YACpBgC,KAAK,EAAE,CAAC;SACT,CAAC;KACH;IAED,IAAI,CAAE,MAAM7B,CAAAA,GAAAA,WAAU,AAAwC,CAAA,WAAxC,CAACF,KAAI,QAAA,CAACC,IAAI,CAACE,cAAc,EAAEN,WAAW,CAAC,CAAC,AAAC,EAAE;QAC/DN,GAAG,CAACyC,IAAI,CAAC,iCAAiC,CAAC;QAC3C,MAAMT,GAAE,QAAA,CAACC,QAAQ,CAACC,KAAK,CAACtB,cAAc,EAAE;YAAEuB,SAAS,EAAE,IAAI;SAAE,CAAC;QAC5D,MAAMO,QAAQ,GAAGjC,KAAI,QAAA,CAACC,IAAI,CACxBE,cAAc,EACd,CAAC,EAAEN,WAAW,CAAC,MAAM,EAAEqC,IAAI,CAACC,GAAG,EAAE,CAAC,CAAC,CACpC;QAED,MAAMC,QAAQ,GAAGC,CAAAA,GAAAA,YAAW,AAAE,CAAA,YAAF,EAAE;QAE9B,MAAMC,CAAAA,GAAAA,UAAK,AAA0C,CAAA,QAA1C,CAAC,CAAC,EAAEF,QAAQ,CAAC,EAAExC,OAAO,CAAC,GAAG,EAAEC,WAAW,CAAC,CAAC,CAAC,CAAC0C,IAAI,CAAC,CAACC,GAAG,GAAK;YAClE,IAAI,CAACA,GAAG,CAACC,EAAE,EAAE;gBACX,MAAM,IAAIvB,KAAK,CAAC,CAAC,2BAA2B,EAAEsB,GAAG,CAACE,MAAM,CAAC,CAAC,CAAC,CAAA;aAC5D;YACD,MAAMC,gBAAgB,GAAGpB,GAAE,QAAA,CAACqB,iBAAiB,CAACX,QAAQ,CAAC;YAEvD,OAAO,IAAIY,OAAO,CAAO,CAACxB,OAAO,EAAEyB,MAAM,GAAK;gBAC5CN,GAAG,CAACO,IAAI,CACLC,IAAI,CAACL,gBAAgB,CAAC,CACtBM,EAAE,CAAC,OAAO,EAAE,CAACC,GAAG,GAAKJ,MAAM,CAACI,GAAG,CAAC,CAAC,CACjCD,EAAE,CAAC,QAAQ,EAAE,IAAM5B,OAAO,EAAE,CAAC;aACjC,CAAC,CAAC8B,OAAO,CAAC,IAAMR,gBAAgB,CAACS,KAAK,EAAE,CAAC,CAAA;SAC3C,CAAC;QACF,MAAM7B,GAAE,QAAA,CAACC,QAAQ,CAAC6B,MAAM,CAACpB,QAAQ,EAAEjC,KAAI,QAAA,CAACC,IAAI,CAACE,cAAc,EAAEN,WAAW,CAAC,CAAC;KAC3E;IACD,MAAM8B,cAAc,EAAE;IAEtB,MAAM2B,UAAU,GAAG,MAAM/B,GAAE,QAAA,CAACC,QAAQ,CAAC+B,OAAO,CAACpD,cAAc,CAAC;IAE5D,IAAImD,UAAU,CAACE,MAAM,GAAGhE,qBAAqB,EAAE;QAC7C8D,UAAU,CAACG,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,GAAK;YACxB,IAAID,CAAC,CAACF,MAAM,GAAGG,CAAC,CAACH,MAAM,EAAE,OAAO,CAAC,CAAC,CAAA;YAClC,OAAOE,CAAC,CAACE,aAAa,CAACD,CAAC,CAAC,CAAA;SAC1B,CAAC;QAEF,iCAAiC;QACjC,IAAK,IAAIE,CAAC,GAAG,CAAC,EAAEA,CAAC,EAAE,EAAEA,CAAC,GAAGP,UAAU,CAACE,MAAM,GAAGhE,qBAAqB,CAAE;YAClE,MAAM+B,GAAE,QAAA,CAACC,QAAQ,CACdsC,MAAM,CAAC9D,KAAI,QAAA,CAACC,IAAI,CAACE,cAAc,EAAEmD,UAAU,CAACO,CAAC,CAAC,CAAC,CAAC,CAChDE,KAAK,CAAC,IAAM,EAAE,CAAC;SACnB;KACF;CACF"}